{
  "gameId": "spark_plug_schema",
  "version": 0.2,

  "numberFormat": {
    "type": "mantissaExponent|decimalString",
    "precision": 16
  },

  "resources": [
    {
      "id": "string",
      "displayName": "string",
      "kind": "softCurrency|hardCurrency|metaCurrency|inventory",
      "format": { "style": "currency|suffix|plain", "symbol": "string?" },
      "stackLimit": null
    }
  ],

  "phases": [
    { "id": "phase.1", "displayName": "string", "description": "string?" }
  ],

  "zones": [
    {
      "id": "zone.main",
      "displayName": "string",
      "presentation": {
        "descriptionKey": "localizationKey?",
        "iconId": "iconId?",
        "imageId": "imageId?"
      },
      "description": "string?",
      "startingPhaseId": "phase.1",
      "localResources": ["resourceId"],
      "tags": ["string"]
    }
  ],

  "computedVars": [
    {
      "id": "var.clipPrice",
      "displayName": "string?",
      "zoneId": "zone.main",
      "base": "numberString",
      "min": null,
      "max": null,
      "rounding": "none|floor|truncate|bankers",
      "expression": {
        "type": "constant|add|multiply|power|log10|min|max|clamp|if",
        "args": []
      },
      "dependsOn": ["resource.resourceId", "state.run.someKey", "var.otherVar"]
    }
  ],

  "nodes": [
    {
      "id": "nodeTypeId",
      "type": "producer|converter|bottleneck|sink",
      "displayName": "string",
      "presentation": {
        "descriptionKey": "localizationKey?",
        "iconId": "iconId?",
        "imageId": "imageId?"
      },
      "tags": ["string"],

      "zoneId": "zone.main",

      "inputs": [
        {
          "resource": "resourceId",
          "amountPerCycle": "numberString?",
          "amountPerCycleFromVar": "varId?",
          "amountPerCycleFromState": "state.path?"
        }
      ],
      "outputs": [
        {
          "resource": "resourceId",
          "mode": "rate|cycle",
          "basePerSecond": "numberString?",
          "basePayout": "numberString?",
          "amountPerCycle": "numberString?",
          "amountPerCycleFromVar": "varId?",
          "amountPerCycleFromState": "state.path?"
        }
      ],

      "cycle": { "baseDurationSeconds": 1.0 },

      "capacities": [
        {
          "resource": "resourceId",
          "capacityMode": "capacity|throughputPerSecond",
          "baseCapacity": "numberString?",
          "baseCapacityPerSecond": "numberString?"
        }
      ],

      "leveling": {
        "levelResource": "resourceId",
        "baseLevel": 0,
        "maxLevel": null,

        "priceCurve": {
          "type": "exponential|linear|piecewise|table",
          "basePrice": "numberString",
          "growth": "numberString?",
          "increment": "numberString?",
          "table": [{ "level": 1, "price": "numberString" }],
          "segments": [
            {
              "fromLevel": 1,
              "toLevel": 50,
              "curve": {
                "type": "exponential",
                "basePrice": "10",
                "growth": "1.12"
              }
            }
          ]
        },

        "outputScaling": [
          {
            "target": "outputs[resourceId].basePerSecond|outputs[resourceId].basePayout|outputs[resourceId].amountPerCycle",
            "perLevel": { "type": "add|multiply", "value": "numberString" }
          }
        ],

        "capacityScaling": [
          {
            "target": "capacities[resourceId].baseCapacity|capacities[resourceId].baseCapacityPerSecond",
            "perLevel": { "type": "add|multiply", "value": "numberString" }
          }
        ]
      },

      "automation": {
        "policy": "alwaysOn|manualCollect|autoRepeat|manualStart",
        "autoCollect": true,
        "autoRestart": true
      },

      "requirements": [
        {
          "type": "resourceAtLeast|unlock|nodeLevelAtLeast|phaseAtLeast|zoneUnlocked",
          "args": {}
        }
      ]
    }
  ],

  "nodeInstances": [
    {
      "id": "instanceId",
      "nodeId": "nodeTypeId",
      "zoneId": "zone.main",
      "displayNameOverride": "string?",
      "tags": ["string"],
      "initialState": { "level": 0, "enabled": true }
    }
  ],

  "links": [
    {
      "id": "linkId",
      "zoneId": "zone.main",
      "from": "instanceId|nodeTypeId",
      "to": "instanceId|nodeTypeId",
      "resource": "resourceId",
      "mode": "push|pull",
      "priority": 0,
      "lossFactor": "1.0",
      "capacityPerSecondFrom": "state.path?|varId?",
      "enabledRequirements": []
    }
  ],

  "modifiers": [
    {
      "id": "modifierId",
      "source": "upgradeId|milestoneId|buffId|projectId|prestige|system",
      "zoneId": "zone.main",
      "scope": {
        "kind": "global|zone|node|nodeTag|resource",
        "zoneId": "zone.main?",
        "nodeId": "nodeTypeId?",
        "nodeTag": "string?",
        "resource": "resourceId?"
      },
      "operation": "add|multiply|set|clampMin|clampMax",
      "target": "resourceGain.resourceId|nodeOutput.resourceId|nodeCapacity.resourceId.throughputPerSecond|state.run.key|var.varId|automation.policy",
      "value": "numberString?",
      "valueFromState": "state.path?",
      "valueFromVar": "varId?",
      "conditions": [
        {
          "type": "phaseAtLeast|zone|nodeEnabled|hasUpgrade|randomChance",
          "args": {}
        }
      ]
    }
  ],

  "upgrades": [
    {
      "id": "upgradeId",
      "displayName": "string",
      "presentation": {
        "descriptionKey": "localizationKey?",
        "iconId": "iconId?",
        "imageId": "imageId?"
      },
      "category": "upgrade|research|card",
      "zoneId": "zone.main",

      "cost": [{ "resource": "resourceId", "amount": "numberString" }],

      "repeatable": false,
      "maxRank": 1,
      "rankCostScaling": {
        "type": "exponential|linear|table",
        "basePriceMultiplier": "1",
        "growth": "1.15"
      },

      "effects": [{ "modifierId": "modifierId" }],

      "requirements": [],
      "tags": ["string"]
    }
  ],

  "milestones": [
    {
      "id": "milestoneId",
      "presentation": {
        "descriptionKey": "localizationKey?",
        "iconId": "iconId?",
        "imageId": "imageId?"
      },
      "nodeId": "nodeTypeId",
      "zoneId": "zone.main",
      "atLevel": 25,
      "grantEffects": [{ "modifierId": "modifierId" }]
    }
  ],

  "projects": [
    {
      "id": "projectId",
      "displayName": "string",
      "presentation": {
        "descriptionKey": "localizationKey?",
        "iconId": "iconId?",
        "imageId": "imageId?"
      },
      "zoneId": "zone.main",
      "timeSeconds": 0,
      "cost": [{ "resource": "resourceId", "amount": "numberString" }],
      "effects": [{ "modifierId": "modifierId" }],
      "requirements": [],
      "exclusiveGroup": "string?",
      "tags": ["string"]
    }
  ],

  "unlockGraph": [
    {
      "id": "unlockId",
      "zoneId": "zone.main",
      "unlocks": [
        {
          "kind": "node|nodeInstance|upgrade|project|zone|phase|modifier",
          "id": "string"
        }
      ],
      "requirements": []
    }
  ],

  "buffs": [
    {
      "id": "buffId",
      "displayName": "string",
      "presentation": {
        "descriptionKey": "localizationKey?",
        "iconId": "iconId?",
        "imageId": "imageId?"
      },
      "zoneId": "zone.main",
      "durationSeconds": 600,
      "stacking": "refresh|extend|ignore|stack",
      "effects": [
        {
          "id": "buffModifierId",
          "source": "buffId",
          "zoneId": "zone.main",
          "scope": { "kind": "global" },
          "operation": "multiply",
          "target": "resourceGain.resourceId",
          "value": "2"
        }
      ]
    }
  ],

  "prestige": {
    "enabled": false,
    "zoneId": "zone.main",
    "prestigeResource": "resourceId",
    "formula": {
      "type": "sqrt|log10|linear|customExpression",
      "basedOn": "lifetimeEarnings.resourceId|state.path|resource.resourceId",
      "multiplier": "numberString",
      "offset": "numberString",
      "expressionVarId": "varId?"
    },
    "resetScopes": {
      "resetNodes": true,
      "resetSoftCurrencies": true,
      "keepHardCurrencies": true,
      "keepUnlocks": [],
      "keepUpgrades": [],
      "keepProjects": []
    },
    "metaUpgrades": [
      {
        "id": "metaUpgradeId",
        "displayName": "string",
        "computed": {
          "type": "linear",
          "basedOn": "resource.resourceId",
          "multiplier": "0.01",
          "offset": "1"
        },
        "writesToState": "state.path"
      }
    ]
  }
}
